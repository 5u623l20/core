{% if helpers.exists('Elastic.Filebeat') %}
######################## Filebeat Configuration ###############################

#=========================== Filebeat prospectors =============================
filebeat.prospectors:
- type: log
  enabled: {{ Elastic.Filebeat.inputs.log.enabled|default('false') }}
  paths:
{% set log_paths = Elastic.Filebeat.inputs.log.paths.split('\n') %}
{% for path in log_paths %}
    - {{ path|trim }}
{% endfor %}

#================================ General =====================================
name: "{{ system.hostname|trim }}"
tags: ["cfai-sensor"]

#================================ Outputs =====================================
output.logstash:
  enabled: {% if Elastic.Filebeat.general.output == "logstash" %}true{% else %}false{% endif %}

{% set logstash_hosts = Elastic.Filebeat.outputs.logstash.hosts.split('\n') %}
  hosts: [{% for host in logstash_hosts %}"{{ host|trim }}"{{ "," if not loop.last }}{% endfor %}]
{% if Elastic.Filebeat.outputs.logstash.ssl.enabled == "1" %}
  ssl.certificate_authorities: ["/usr/local/etc/filebeat/filebeat-ca.crt"]
  ssl.certificate: "/usr/local/etc/filebeat/filebeat.crt"
  ssl.key: "/usr/local/etc/filebeat/filebeat.key"
{% endif %}

{% endif %}